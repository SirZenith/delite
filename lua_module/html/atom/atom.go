package atom

import (
	"sync"

	lua "github.com/yuin/gopher-lua"
	"golang.org/x/net/html/atom"
)

func Loader(L *lua.LState) int {
	mod := L.SetFuncs(L.NewTable(), exports)

	addAtomConst(L, mod)

	L.Push(mod)

	return 1
}

var exports = map[string]lua.LGFunction{
	"tostring": toString,
}

var (
	atomMap     map[string]atom.Atom
	onceAtomTbl sync.Once
)

func addAtomConst(L *lua.LState, mod *lua.LTable) {
	onceAtomTbl.Do(func() {
		atomMap = map[string]atom.Atom{
			"A":                         atom.A,
			"Abbr":                      atom.Abbr,
			"Accept":                    atom.Accept,
			"AcceptCharset":             atom.AcceptCharset,
			"Accesskey":                 atom.Accesskey,
			"Acronym":                   atom.Acronym,
			"Action":                    atom.Action,
			"Address":                   atom.Address,
			"Align":                     atom.Align,
			"Allowfullscreen":           atom.Allowfullscreen,
			"Allowpaymentrequest":       atom.Allowpaymentrequest,
			"Allowusermedia":            atom.Allowusermedia,
			"Alt":                       atom.Alt,
			"Annotation":                atom.Annotation,
			"AnnotationXml":             atom.AnnotationXml,
			"Applet":                    atom.Applet,
			"Area":                      atom.Area,
			"Article":                   atom.Article,
			"As":                        atom.As,
			"Aside":                     atom.Aside,
			"Async":                     atom.Async,
			"Audio":                     atom.Audio,
			"Autocomplete":              atom.Autocomplete,
			"Autofocus":                 atom.Autofocus,
			"Autoplay":                  atom.Autoplay,
			"B":                         atom.B,
			"Base":                      atom.Base,
			"Basefont":                  atom.Basefont,
			"Bdi":                       atom.Bdi,
			"Bdo":                       atom.Bdo,
			"Bgsound":                   atom.Bgsound,
			"Big":                       atom.Big,
			"Blink":                     atom.Blink,
			"Blockquote":                atom.Blockquote,
			"Body":                      atom.Body,
			"Br":                        atom.Br,
			"Button":                    atom.Button,
			"Canvas":                    atom.Canvas,
			"Caption":                   atom.Caption,
			"Center":                    atom.Center,
			"Challenge":                 atom.Challenge,
			"Charset":                   atom.Charset,
			"Checked":                   atom.Checked,
			"Cite":                      atom.Cite,
			"Class":                     atom.Class,
			"Code":                      atom.Code,
			"Col":                       atom.Col,
			"Colgroup":                  atom.Colgroup,
			"Color":                     atom.Color,
			"Cols":                      atom.Cols,
			"Colspan":                   atom.Colspan,
			"Command":                   atom.Command,
			"Content":                   atom.Content,
			"Contenteditable":           atom.Contenteditable,
			"Contextmenu":               atom.Contextmenu,
			"Controls":                  atom.Controls,
			"Coords":                    atom.Coords,
			"Crossorigin":               atom.Crossorigin,
			"Data":                      atom.Data,
			"Datalist":                  atom.Datalist,
			"Datetime":                  atom.Datetime,
			"Dd":                        atom.Dd,
			"Default":                   atom.Default,
			"Defer":                     atom.Defer,
			"Del":                       atom.Del,
			"Desc":                      atom.Desc,
			"Details":                   atom.Details,
			"Dfn":                       atom.Dfn,
			"Dialog":                    atom.Dialog,
			"Dir":                       atom.Dir,
			"Dirname":                   atom.Dirname,
			"Disabled":                  atom.Disabled,
			"Div":                       atom.Div,
			"Dl":                        atom.Dl,
			"Download":                  atom.Download,
			"Draggable":                 atom.Draggable,
			"Dropzone":                  atom.Dropzone,
			"Dt":                        atom.Dt,
			"Em":                        atom.Em,
			"Embed":                     atom.Embed,
			"Enctype":                   atom.Enctype,
			"Face":                      atom.Face,
			"Fieldset":                  atom.Fieldset,
			"Figcaption":                atom.Figcaption,
			"Figure":                    atom.Figure,
			"Font":                      atom.Font,
			"Footer":                    atom.Footer,
			"For":                       atom.For,
			"ForeignObject":             atom.ForeignObject,
			"Foreignobject":             atom.Foreignobject,
			"Form":                      atom.Form,
			"Formaction":                atom.Formaction,
			"Formenctype":               atom.Formenctype,
			"Formmethod":                atom.Formmethod,
			"Formnovalidate":            atom.Formnovalidate,
			"Formtarget":                atom.Formtarget,
			"Frame":                     atom.Frame,
			"Frameset":                  atom.Frameset,
			"H1":                        atom.H1,
			"H2":                        atom.H2,
			"H3":                        atom.H3,
			"H4":                        atom.H4,
			"H5":                        atom.H5,
			"H6":                        atom.H6,
			"Head":                      atom.Head,
			"Header":                    atom.Header,
			"Headers":                   atom.Headers,
			"Height":                    atom.Height,
			"Hgroup":                    atom.Hgroup,
			"Hidden":                    atom.Hidden,
			"High":                      atom.High,
			"Hr":                        atom.Hr,
			"Href":                      atom.Href,
			"Hreflang":                  atom.Hreflang,
			"Html":                      atom.Html,
			"HttpEquiv":                 atom.HttpEquiv,
			"I":                         atom.I,
			"Icon":                      atom.Icon,
			"Id":                        atom.Id,
			"Iframe":                    atom.Iframe,
			"Image":                     atom.Image,
			"Img":                       atom.Img,
			"Input":                     atom.Input,
			"Inputmode":                 atom.Inputmode,
			"Ins":                       atom.Ins,
			"Integrity":                 atom.Integrity,
			"Is":                        atom.Is,
			"Isindex":                   atom.Isindex,
			"Ismap":                     atom.Ismap,
			"Itemid":                    atom.Itemid,
			"Itemprop":                  atom.Itemprop,
			"Itemref":                   atom.Itemref,
			"Itemscope":                 atom.Itemscope,
			"Itemtype":                  atom.Itemtype,
			"Kbd":                       atom.Kbd,
			"Keygen":                    atom.Keygen,
			"Keytype":                   atom.Keytype,
			"Kind":                      atom.Kind,
			"Label":                     atom.Label,
			"Lang":                      atom.Lang,
			"Legend":                    atom.Legend,
			"Li":                        atom.Li,
			"Link":                      atom.Link,
			"List":                      atom.List,
			"Listing":                   atom.Listing,
			"Loop":                      atom.Loop,
			"Low":                       atom.Low,
			"Main":                      atom.Main,
			"Malignmark":                atom.Malignmark,
			"Manifest":                  atom.Manifest,
			"Map":                       atom.Map,
			"Mark":                      atom.Mark,
			"Marquee":                   atom.Marquee,
			"Math":                      atom.Math,
			"Max":                       atom.Max,
			"Maxlength":                 atom.Maxlength,
			"Media":                     atom.Media,
			"Mediagroup":                atom.Mediagroup,
			"Menu":                      atom.Menu,
			"Menuitem":                  atom.Menuitem,
			"Meta":                      atom.Meta,
			"Meter":                     atom.Meter,
			"Method":                    atom.Method,
			"Mglyph":                    atom.Mglyph,
			"Mi":                        atom.Mi,
			"Min":                       atom.Min,
			"Minlength":                 atom.Minlength,
			"Mn":                        atom.Mn,
			"Mo":                        atom.Mo,
			"Ms":                        atom.Ms,
			"Mtext":                     atom.Mtext,
			"Multiple":                  atom.Multiple,
			"Muted":                     atom.Muted,
			"Name":                      atom.Name,
			"Nav":                       atom.Nav,
			"Nobr":                      atom.Nobr,
			"Noembed":                   atom.Noembed,
			"Noframes":                  atom.Noframes,
			"Nomodule":                  atom.Nomodule,
			"Nonce":                     atom.Nonce,
			"Noscript":                  atom.Noscript,
			"Novalidate":                atom.Novalidate,
			"Object":                    atom.Object,
			"Ol":                        atom.Ol,
			"Onabort":                   atom.Onabort,
			"Onafterprint":              atom.Onafterprint,
			"Onautocomplete":            atom.Onautocomplete,
			"Onautocompleteerror":       atom.Onautocompleteerror,
			"Onauxclick":                atom.Onauxclick,
			"Onbeforeprint":             atom.Onbeforeprint,
			"Onbeforeunload":            atom.Onbeforeunload,
			"Onblur":                    atom.Onblur,
			"Oncancel":                  atom.Oncancel,
			"Oncanplay":                 atom.Oncanplay,
			"Oncanplaythrough":          atom.Oncanplaythrough,
			"Onchange":                  atom.Onchange,
			"Onclick":                   atom.Onclick,
			"Onclose":                   atom.Onclose,
			"Oncontextmenu":             atom.Oncontextmenu,
			"Oncopy":                    atom.Oncopy,
			"Oncuechange":               atom.Oncuechange,
			"Oncut":                     atom.Oncut,
			"Ondblclick":                atom.Ondblclick,
			"Ondrag":                    atom.Ondrag,
			"Ondragend":                 atom.Ondragend,
			"Ondragenter":               atom.Ondragenter,
			"Ondragexit":                atom.Ondragexit,
			"Ondragleave":               atom.Ondragleave,
			"Ondragover":                atom.Ondragover,
			"Ondragstart":               atom.Ondragstart,
			"Ondrop":                    atom.Ondrop,
			"Ondurationchange":          atom.Ondurationchange,
			"Onemptied":                 atom.Onemptied,
			"Onended":                   atom.Onended,
			"Onerror":                   atom.Onerror,
			"Onfocus":                   atom.Onfocus,
			"Onhashchange":              atom.Onhashchange,
			"Oninput":                   atom.Oninput,
			"Oninvalid":                 atom.Oninvalid,
			"Onkeydown":                 atom.Onkeydown,
			"Onkeypress":                atom.Onkeypress,
			"Onkeyup":                   atom.Onkeyup,
			"Onlanguagechange":          atom.Onlanguagechange,
			"Onload":                    atom.Onload,
			"Onloadeddata":              atom.Onloadeddata,
			"Onloadedmetadata":          atom.Onloadedmetadata,
			"Onloadend":                 atom.Onloadend,
			"Onloadstart":               atom.Onloadstart,
			"Onmessage":                 atom.Onmessage,
			"Onmessageerror":            atom.Onmessageerror,
			"Onmousedown":               atom.Onmousedown,
			"Onmouseenter":              atom.Onmouseenter,
			"Onmouseleave":              atom.Onmouseleave,
			"Onmousemove":               atom.Onmousemove,
			"Onmouseout":                atom.Onmouseout,
			"Onmouseover":               atom.Onmouseover,
			"Onmouseup":                 atom.Onmouseup,
			"Onmousewheel":              atom.Onmousewheel,
			"Onoffline":                 atom.Onoffline,
			"Ononline":                  atom.Ononline,
			"Onpagehide":                atom.Onpagehide,
			"Onpageshow":                atom.Onpageshow,
			"Onpaste":                   atom.Onpaste,
			"Onpause":                   atom.Onpause,
			"Onplay":                    atom.Onplay,
			"Onplaying":                 atom.Onplaying,
			"Onpopstate":                atom.Onpopstate,
			"Onprogress":                atom.Onprogress,
			"Onratechange":              atom.Onratechange,
			"Onrejectionhandled":        atom.Onrejectionhandled,
			"Onreset":                   atom.Onreset,
			"Onresize":                  atom.Onresize,
			"Onscroll":                  atom.Onscroll,
			"Onsecuritypolicyviolation": atom.Onsecuritypolicyviolation,
			"Onseeked":                  atom.Onseeked,
			"Onseeking":                 atom.Onseeking,
			"Onselect":                  atom.Onselect,
			"Onshow":                    atom.Onshow,
			"Onsort":                    atom.Onsort,
			"Onstalled":                 atom.Onstalled,
			"Onstorage":                 atom.Onstorage,
			"Onsubmit":                  atom.Onsubmit,
			"Onsuspend":                 atom.Onsuspend,
			"Ontimeupdate":              atom.Ontimeupdate,
			"Ontoggle":                  atom.Ontoggle,
			"Onunhandledrejection":      atom.Onunhandledrejection,
			"Onunload":                  atom.Onunload,
			"Onvolumechange":            atom.Onvolumechange,
			"Onwaiting":                 atom.Onwaiting,
			"Onwheel":                   atom.Onwheel,
			"Open":                      atom.Open,
			"Optgroup":                  atom.Optgroup,
			"Optimum":                   atom.Optimum,
			"Option":                    atom.Option,
			"Output":                    atom.Output,
			"P":                         atom.P,
			"Param":                     atom.Param,
			"Pattern":                   atom.Pattern,
			"Picture":                   atom.Picture,
			"Ping":                      atom.Ping,
			"Placeholder":               atom.Placeholder,
			"Plaintext":                 atom.Plaintext,
			"Playsinline":               atom.Playsinline,
			"Poster":                    atom.Poster,
			"Pre":                       atom.Pre,
			"Preload":                   atom.Preload,
			"Progress":                  atom.Progress,
			"Prompt":                    atom.Prompt,
			"Public":                    atom.Public,
			"Q":                         atom.Q,
			"Radiogroup":                atom.Radiogroup,
			"Rb":                        atom.Rb,
			"Readonly":                  atom.Readonly,
			"Referrerpolicy":            atom.Referrerpolicy,
			"Rel":                       atom.Rel,
			"Required":                  atom.Required,
			"Reversed":                  atom.Reversed,
			"Rows":                      atom.Rows,
			"Rowspan":                   atom.Rowspan,
			"Rp":                        atom.Rp,
			"Rt":                        atom.Rt,
			"Rtc":                       atom.Rtc,
			"Ruby":                      atom.Ruby,
			"S":                         atom.S,
			"Samp":                      atom.Samp,
			"Sandbox":                   atom.Sandbox,
			"Scope":                     atom.Scope,
			"Scoped":                    atom.Scoped,
			"Script":                    atom.Script,
			"Seamless":                  atom.Seamless,
			"Section":                   atom.Section,
			"Select":                    atom.Select,
			"Selected":                  atom.Selected,
			"Shape":                     atom.Shape,
			"Size":                      atom.Size,
			"Sizes":                     atom.Sizes,
			"Slot":                      atom.Slot,
			"Small":                     atom.Small,
			"Sortable":                  atom.Sortable,
			"Sorted":                    atom.Sorted,
			"Source":                    atom.Source,
			"Spacer":                    atom.Spacer,
			"Span":                      atom.Span,
			"Spellcheck":                atom.Spellcheck,
			"Src":                       atom.Src,
			"Srcdoc":                    atom.Srcdoc,
			"Srclang":                   atom.Srclang,
			"Srcset":                    atom.Srcset,
			"Start":                     atom.Start,
			"Step":                      atom.Step,
			"Strike":                    atom.Strike,
			"Strong":                    atom.Strong,
			"Style":                     atom.Style,
			"Sub":                       atom.Sub,
			"Summary":                   atom.Summary,
			"Sup":                       atom.Sup,
			"Svg":                       atom.Svg,
			"System":                    atom.System,
			"Tabindex":                  atom.Tabindex,
			"Table":                     atom.Table,
			"Target":                    atom.Target,
			"Tbody":                     atom.Tbody,
			"Td":                        atom.Td,
			"Template":                  atom.Template,
			"Textarea":                  atom.Textarea,
			"Tfoot":                     atom.Tfoot,
			"Th":                        atom.Th,
			"Thead":                     atom.Thead,
			"Time":                      atom.Time,
			"Title":                     atom.Title,
			"Tr":                        atom.Tr,
			"Track":                     atom.Track,
			"Translate":                 atom.Translate,
			"Tt":                        atom.Tt,
			"Type":                      atom.Type,
			"Typemustmatch":             atom.Typemustmatch,
			"U":                         atom.U,
			"Ul":                        atom.Ul,
			"Updateviacache":            atom.Updateviacache,
			"Usemap":                    atom.Usemap,
			"Value":                     atom.Value,
			"Var":                       atom.Var,
			"Video":                     atom.Video,
			"Wbr":                       atom.Wbr,
			"Width":                     atom.Width,
			"Workertype":                atom.Workertype,
			"Wrap":                      atom.Wrap,
			"Xmp":                       atom.Xmp,
		}
	})

	for name, value := range atomMap {
		L.SetField(mod, name, lua.LNumber(value))
	}
}

func toString(L *lua.LState) int {
	val := L.CheckInt64(1)
	str := atom.Atom(val).String()

	L.Push(lua.LString(str))

	return 1
}
